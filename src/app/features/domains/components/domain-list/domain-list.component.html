<div class="page-root">
  <!-- Header -->
  <div class="page-header flex justify-between items-center mb-6">
    <div>
      <h1>Domains</h1>
      <p class="page-subtitle">Manage your email domains, DNS records, and DKIM keys.</p>
    </div>
    <button
      (click)="openAddModal()"
      class="btn-primary btn-md">
      + Add Domain
    </button>
  </div>

  <!-- Error banner -->
  <div *ngIf="error" class="alert alert-destructive mb-4">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg>
    <div>
      {{ error }}
    </div>
  </div>

  <!-- Loading spinner -->
  <div *ngIf="loading" class="flex justify-center items-center py-16">
    <mat-spinner diameter="40"></mat-spinner>
  </div>

  <!-- Domain table -->
  <div *ngIf="!loading" class="card">
    <div class="card-content p-0">
      <table class="table">
        <thead class="table-header">
          <tr>
            <th class="table-head">Domain</th>
            <th class="table-head">Status</th>
            <th class="table-head">DNS Provider</th>
            <th class="table-head">Last Health Check</th>
            <th class="table-head">Created</th>
            <th class="table-head text-right">Actions</th>
          </tr>
        </thead>
        <tbody class="table-body">
          <tr
            *ngFor="let domain of domains"
            (click)="viewDomain(domain)"
            class="table-row cursor-pointer">
            <td class="table-cell font-medium">
              {{ domain.domain }}
            </td>
            <td class="table-cell">
              <span class="badge" [ngClass]="getStatusClass(domain.status)">
                {{ domain.status || 'PENDING' }}
              </span>
            </td>
            <td class="table-cell text-muted-foreground">
              {{ domain.dnsProviderId ? 'Provider #' + domain.dnsProviderId : '—' }}
            </td>
            <td class="table-cell text-muted-foreground">
              {{ domain.lastHealthCheck ? (domain.lastHealthCheck | date:'short') : '—' }}
            </td>
            <td class="table-cell text-muted-foreground">
              {{ domain.createdAt ? (domain.createdAt | date:'mediumDate') : '—' }}
            </td>
            <td class="table-cell text-right">
              <button
                (click)="deleteDomain(domain, $event)"
                class="btn-ghost text-destructive hover:text-destructive/90">
                Delete
              </button>
            </td>
          </tr>
          <tr *ngIf="domains.length === 0" class="table-row hover:bg-transparent">
            <td colspan="6" class="table-cell text-center py-12 text-muted-foreground">
              No domains found. Add your first domain to get started.
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<!-- Add Domain Modal -->
<div *ngIf="showAddModal" class="fixed inset-0 bg-background/80 backdrop-blur-sm flex items-center justify-center z-50">
  <div class="card w-full max-w-md shadow-lg border-border">
    <div class="card-header border-b border-border">
      <h3 class="card-title text-lg">Add Domain</h3>
    </div>
    <div class="card-content pt-6">
      <div class="space-y-4">
        <div class="space-y-2">
          <label class="text-sm font-medium leading-none">Domain Name</label>
          <input
            type="text"
            [(ngModel)]="newDomainName"
            placeholder="example.com"
            class="input"
            (keyup.enter)="addDomain()" />
        </div>
      </div>
    </div>
    <div class="card-footer justify-end space-x-2 border-t border-border pt-6 mt-6">
      <button
        (click)="closeAddModal()"
        class="btn-outline btn-md">
        Cancel
      </button>
      <button
        (click)="addDomain()"
        [disabled]="!newDomainName.trim()"
        class="btn-primary btn-md">
        Add Domain
      </button>
    </div>
  </div>
</div>
