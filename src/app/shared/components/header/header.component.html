<header class="top-bar">
  <div class="top-bar-left">
    <!-- Breadcrumb -->
    <nav class="breadcrumb" aria-label="breadcrumb">
      <span class="breadcrumb-item">Robin MTA</span>
      <span class="breadcrumb-sep">/</span>
      <span class="breadcrumb-item active">{{ pageTitle }}</span>
    </nav>
  </div>

  <div class="top-bar-right">
    <!-- Server Status -->
    @if (authStore.isAuthenticated()) {
      <div class="status-pill">
        <span class="status-dot"></span>
        <span class="status-label">Server</span>
        <app-status-badge [status]="serverStatus"></app-status-badge>
      </div>
    }

    <!-- Theme Picker -->
    <app-theme-picker></app-theme-picker>

    <!-- Notifications -->
    <button class="icon-btn" aria-label="Notifications" title="Notifications">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
        <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
      </svg>
    </button>

    <!-- User menu -->
    @if (authStore.isAuthenticated()) {
      <div class="user-menu-wrap">
        <button
          (click)="toggleUserMenu($event)"
          class="avatar-btn"
          aria-label="User menu">
          <div class="avatar">
            @if (authStore.username()) {
              <span>{{ authStore.username().charAt(0).toUpperCase() }}</span>
            } @else {
              <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                <circle cx="12" cy="7" r="4"></circle>
              </svg>
            }
          </div>
          @if (authStore.username()) {
            <span class="username">{{ authStore.username() }}</span>
          }
        </button>

        @if (showUserMenu) {
          <div class="user-dropdown" (click)="$event.stopPropagation()">
            <div class="dropdown-header">
              <p class="dropdown-name">{{ authStore.username() }}</p>
              <p class="dropdown-email">{{ authStore.userEmail() }}</p>
            </div>
            <div class="dropdown-body">
              <button (click)="logout()" class="dropdown-item">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                  <polyline points="16 17 21 12 16 7"></polyline>
                  <line x1="21" y1="12" x2="9" y2="12"></line>
                </svg>
                Logout
              </button>
            </div>
          </div>
        }
      </div>
    }
  </div>
</header>
