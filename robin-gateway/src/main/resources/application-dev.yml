spring:
  # Development profile - uses environment variables with local development defaults
  # Docker: Environment variables are set in docker-compose.yml
  # Local: Uses defaults (localhost:5433 for suite-postgres, localhost:6379 for Redis)
  datasource:
    url: jdbc:postgresql://${DB_HOST:localhost}:${DB_PORT:5433}/${DB_NAME:robin}
    username: ${DB_USER:robin}
    password: ${DB_PASSWORD:robin}

  jpa:
    show-sql: true
    properties:
      hibernate:
        format_sql: true

  data:
    redis:
      host: ${REDIS_HOST:localhost}
      port: ${REDIS_PORT:6379}

  cloud:
    gateway:
      routes:
        # Development routes - use environment variables with local development defaults
        # Docker: ROBIN_CLIENT_URL and ROBIN_SERVICE_URL set in docker-compose.yml
        # Local: Uses localhost with suite ports (28080, 28090)
        - id: queue_route
          uri: ${ROBIN_CLIENT_URL:http://localhost:28090}
          predicates:
            - Path=/api/v1/queue/**
          filters:
            - RewritePath=/api/v1/queue/(?<segment>.*), /client/queue/${segment}
        - id: storage_route
          uri: ${ROBIN_CLIENT_URL:http://localhost:28090}
          predicates:
            - Path=/api/v1/storage/**
          filters:
            - RewritePath=/api/v1/storage/(?<segment>.*), /store/${segment}
        - id: logs_route
          uri: ${ROBIN_CLIENT_URL:http://localhost:28090}
          predicates:
            - Path=/api/v1/logs/**
          filters:
            - RewritePath=/api/v1/logs/(?<segment>.*), /logs/${segment}
        - id: config_route
          uri: ${ROBIN_SERVICE_URL:http://localhost:28080}
          predicates:
            - Path=/api/v1/config/**
          filters:
            - RewritePath=/api/v1/config/(?<segment>.*), /config/${segment}
        - id: metrics_route
          uri: ${ROBIN_SERVICE_URL:http://localhost:28080}
          predicates:
            - Path=/api/v1/metrics/**
          filters:
            - RewritePath=/api/v1/metrics/(?<segment>.*), /metrics/${segment}

logging:
  level:
    root: INFO
    com.robin.gateway: DEBUG
    org.springframework.cloud.gateway: TRACE
    org.springframework.security: DEBUG
    org.springframework.web: DEBUG
